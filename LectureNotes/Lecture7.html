<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Julia Schedler">

<title>Fall 24 Stat 416 Lecture Notes - Lecture 7 Solutions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../LectureNotes/Lecture7.html">Week 4</a></li><li class="breadcrumb-item"><a href="../LectureNotes/Lecture7.html">Lecture 7 Solutions</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Fall 24 Stat 416 Lecture Notes</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Week 1</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../LectureNotes/Lecture1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../LectureNotes/Lecture2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Assignments/Assignment1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 1</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Week 2</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../LectureNotes/Lecture3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../LectureNotes/Lecture4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 4</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Assignments/Assignment2_updated.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 2</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Week 3</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../LectureNotes/Lecture5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 5</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../LectureNotes/Lecture6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 6</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Assignments/Assignment3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 3</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Week 4</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../LectureNotes/Lecture7.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Lecture 7 Solutions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../LectureNotes/Lecture8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 8 (with solutions)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Week 5</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../LectureNotes/Lecture9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 9</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#activity-1-solutions-fill-out-this-table" id="toc-activity-1-solutions-fill-out-this-table" class="nav-link active" data-scroll-target="#activity-1-solutions-fill-out-this-table">Activity 1 Solutions: Fill out this table</a></li>
  <li><a href="#activity-2-solutions" id="toc-activity-2-solutions" class="nav-link" data-scroll-target="#activity-2-solutions">Activity 2 Solutions</a>
  <ul class="collapse">
  <li><a href="#code-solutions" id="toc-code-solutions" class="nav-link" data-scroll-target="#code-solutions">Code solutions</a></li>
  <li><a href="#short-answer-answers" id="toc-short-answer-answers" class="nav-link" data-scroll-target="#short-answer-answers">Short answer answers</a></li>
  </ul></li>
  <li><a href="#activity-3" id="toc-activity-3" class="nav-link" data-scroll-target="#activity-3">Activity 3</a></li>
  <li><a href="#activity-4" id="toc-activity-4" class="nav-link" data-scroll-target="#activity-4">Activity 4</a></li>
  <li><a href="#simulation-solutions." id="toc-simulation-solutions." class="nav-link" data-scroll-target="#simulation-solutions.">Simulation solutions.</a></li>
  <li><a href="#why-doesnt-the-acf-of-the-ma5-look-like-white-noise" id="toc-why-doesnt-the-acf-of-the-ma5-look-like-white-noise" class="nav-link" data-scroll-target="#why-doesnt-the-acf-of-the-ma5-look-like-white-noise">Why doesn’t the acf of the MA(5) look like white noise?</a></li>
  <li><a href="#a-bit-about-the-nile-data" id="toc-a-bit-about-the-nile-data" class="nav-link" data-scroll-target="#a-bit-about-the-nile-data">A bit about the Nile Data</a></li>
  <li><a href="#wheres-aswan" id="toc-wheres-aswan" class="nav-link" data-scroll-target="#wheres-aswan">Where’s Aswan?</a></li>
  <li><a href="#a-bit-about-the-nile-data-1" id="toc-a-bit-about-the-nile-data-1" class="nav-link" data-scroll-target="#a-bit-about-the-nile-data-1">A bit about the Nile Data</a></li>
  <li><a href="#check-out-the-paper" id="toc-check-out-the-paper" class="nav-link" data-scroll-target="#check-out-the-paper">Check out the paper!</a></li>
  <li><a href="#whos-barbara-bell" id="toc-whos-barbara-bell" class="nav-link" data-scroll-target="#whos-barbara-bell">Who’s Barbara Bell?</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../LectureNotes/Lecture7.html">Week 4</a></li><li class="breadcrumb-item"><a href="../LectureNotes/Lecture7.html">Lecture 7 Solutions</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Lecture 7 Solutions</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Julia Schedler </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div class="hidden">
<p><span class="math display">\[
\newcommand\E{{\mathbb{E}}}
\]</span></p>
</div>
<section id="activity-1-solutions-fill-out-this-table" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="activity-1-solutions-fill-out-this-table">Activity 1 Solutions: Fill out this table</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 1%">
<col style="width: 4%">
<col style="width: 10%">
<col style="width: 83%">
</colgroup>
<thead>
<tr class="header">
<th>Phrase</th>
<th>Symbols</th>
<th>Words</th>
<th>Bonus content</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(x_t\)</span> are white noise</td>
<td><p><span class="math inline">\(\E(x_t) = 0\)</span><span class="math display">\[\gamma(s,t) = \begin{cases} \sigma^2_w&amp; \text{ if } s = t\\ 0&amp; \text{ if } s \ne t \end{cases}\]</span></p>
<p><span class="math inline">\(x_i\)</span> are i.i.d.</p></td>
<td>“Marginally (for a given <span class="math inline">\(t\)</span>), <span class="math inline">\(x_t\)</span> (”<span class="math inline">\(x\)</span> of <span class="math inline">\(t\)</span>” or “<span class="math inline">\(x\)</span> sub <span class="math inline">\(t\)</span>”) follows some distribution follows some distribution that is zero on average and are uncorrelated sigma w (sigma sub w) (except for when <span class="math inline">\(s = t\)</span>, then the and <span class="math inline">\(x_s\)</span> is independent of <span class="math inline">\(x_t\)</span> for all $s, t4</td>
<td>“When we talk about white noise, an assumption is independence which necessarily implies we have multiple values of <span class="math inline">\(t\)</span>, and for each value of <span class="math inline">\(t\)</span> we have a random vector <span class="math inline">\(x_t\)</span> which satisfies the distributional assumptions. Also <span class="math display">\[\gamma(t,t) = \sigma^2_w = \text{marginal variance of }x_t  \]</span>”Gamma of t comma t is sigma squared w and is called the marginal variance of <span class="math inline">\(x_t\)</span> , where we consider <span class="math inline">\(x_t\)</span> to be a univariate random variable (think about how the word distribution was used in intro stats, that’s the setting)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(x_t\)</span> is stationary in the mean</td>
<td><span class="math inline">\(\E(x_t)\)</span> is not a function of <span class="math inline">\(t\)</span></td>
<td>The expected value of <span class="math inline">\(x_t\)</span> does not depend on time (have a <span class="math inline">\(t\)</span> in the formula)</td>
<td>This basically equates to <span class="math inline">\(x_t\)</span> having a horizontal trend, where the y-intercept can be any value. For white noise, for example, it’s 0.There is no temporal structure in the average behavior of <span class="math inline">\(x\)</span>.</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(x_t\)</span> is stationary in the auto-covariance</td>
<td><span class="math inline">\(\gamma_x(s,t) = \gamma_x(h)\)</span> for all <span class="math inline">\(s,t\)</span></td>
<td>The autocovariance function depends only on the distance between time points, not the specific values of the time points.</td>
<td>White noise is stationary, but if a time series <span class="math inline">\(x_t\)</span> is stationary it is not necessarily white noise. For example, if <span class="math inline">\(v_t\)</span> is a p-point moving average of white noise, the covariance function of <span class="math inline">\(v_t\)</span> for the case when p = 3 is:<span class="math display">\[  \gamma_v(s,t) = \begin{cases}                                                                                                                                                                                                                                3/9 \sigma^2_w &amp; s-t = 0\\                                                                                                                                                                                                                                    2/9 \sigma^2_w &amp; \vert s-t \vert = 1\\ 1/9 \sigma^2_w &amp; \vert s-t \vert =2 \\                                                                                                                                                                                                                      0 &amp; \vert s-t \vert &gt; 2                                                                                                                                                                                                                                     \end{cases}                                                                                                                                                                                                                                                  \]</span>We can rewrite as a function of <span class="math inline">\(h = s-t\)</span>, meaning <span class="math inline">\(v_t\)</span> is stationary in the autocovariance (or sometimes people just say covariance) This is not the same function as <span class="math inline">\(\gamma_x(s,t)\)</span> for white noise .Specifically, notice that the right hand side contains the “covariance structure”, the possible magnitudes of dependence (left of comma) for given combinations of two time points <span class="math inline">\(s\)</span> and <span class="math inline">\(t\)</span>. This is the meaningful difference between the two functions. The left hand sides, while different because of the subscript, are just symbols for “covariance function of *” where * is the letter part of the time series in question, i.e.&nbsp;<span class="math inline">\(\gamma_v(s,t)\)</span> is the autocovariance function of <span class="math inline">\(v_t\)</span>.</td>
</tr>
<tr class="even">
<td><span class="math inline">\(x_t\)</span> is stationary</td>
<td>Both previous</td>
<td>Both previous</td>
<td>“In general, a stationary time series will have no predictable patterns in the long-term.”- Forecasting Principles and Practice“A&nbsp;stationary&nbsp;time series is one whose statistical properties do not depend on the time at which the series is observed”- Forecasting Principles and Practice</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(x_t\)</span> has temporal structure</td>
<td><span class="math inline">\(\E(x_t)\)</span> is a function of <span class="math inline">\(t\)</span> <span class="math inline">\(\gamma_x(s,t)\)</span> is nonzero for some <span class="math inline">\(s \ne t\)</span></td>
<td><p>On average, the value of the time series <span class="math inline">\(x_t\)</span> varies with respect to <span class="math inline">\(t\)</span>.</p>
<p><span class="math inline">\(x_t\)</span> exhibits temporal autocorrelation, or, knowing the value of <span class="math inline">\(x_t\)</span> tells us something about the likely value of <span class="math inline">\(x_s\)</span> when <span class="math inline">\(\gamma(s,t) &gt; 0\)</span></p></td>
<td>Notice that when the time series is stationary in the mean, we say there is no temporal structure in the mean, but the autocovariance can still have temporal structure and be stationary. (If it didn’t it wouldn’t be a very interesting time series!)</td>
</tr>
</tbody>
</table>
</section>
<section id="activity-2-solutions" class="level2">
<h2 class="anchored" data-anchor-id="activity-2-solutions">Activity 2 Solutions</h2>
<section id="code-solutions" class="level3">
<h3 class="anchored" data-anchor-id="code-solutions">Code solutions</h3>
<ol type="1">
<li>Download the data <code>time_series.csv</code> from Canvas and create a sub-folder in your <code>Lecture7</code> folder called <code>Data</code>. Read in the data. Extract <code>y1</code>, the first time series, and name it <code>x_t</code>. Save it in a data frame called <code>all_ts</code>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(astsa)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>time_series <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data/time_series.csv"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>x_t <span class="ot">&lt;-</span> time_series<span class="sc">$</span>y1</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>all_ts <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x_t, <span class="at">Time =</span> <span class="fu">time</span>(x_t))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>Plot the time series data set using both points and lines.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tsplot</span>(all_ts<span class="sc">$</span>x_t, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">ylab =</span> <span class="st">"TS 1"</span>, <span class="at">main =</span> <span class="st">"Observed Time Series"</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lecture7_files/figure-html/astsa_act2_part2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>(extra content)<code>ggplot</code> version</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(all_ts, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> x_t)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"TS 1"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Observed Time Series #1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="3" type="1">
<li>In separate plot, again plot the time series as just points and also plot a moving average smoother over the time series (use any <span class="math inline">\(p\)</span> you’d like, but use a symmetric one). Create a data frame called <code>all_ts</code> with the original time series and the moving average smoother.</li>
</ol>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tsplot</span>(all_ts<span class="sc">$</span>x_t, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">ylab =</span> <span class="st">"TS 1"</span>, <span class="at">main =</span> <span class="st">"Moving Average Smoother (5 point)"</span>, <span class="at">pch =</span> <span class="dv">16</span> )</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>all_ts<span class="sc">$</span>ma_x_t <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">filter</span>(x_t, <span class="at">filter =</span><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>,<span class="dv">5</span>), <span class="at">sides =</span> <span class="dv">2</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(all_ts<span class="sc">$</span>ma_x_t, <span class="at">col =</span> <span class="st">"magenta"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lecture7_files/figure-html/astsa_act2_p3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>(extra content)<code>ggplot</code> version</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(all_ts, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> x_t)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span> Time, <span class="at">y =</span> ma_x_t), <span class="at">col =</span> <span class="st">"magenta"</span>) <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"TS 1"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Detrended - Moving Average Smoother (5 point)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="4" type="1">
<li><em>Detrend</em> the time series with respect to the moving average estimate and plot the de-trended time series as points and lines. Save the detrended series in <code>all_ts</code>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>all_ts<span class="sc">$</span>detrended_ma <span class="ot">&lt;-</span> all_ts<span class="sc">$</span>x_t <span class="sc">-</span> all_ts<span class="sc">$</span>ma_x_t</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tsplot</span>(all_ts<span class="sc">$</span>detrended, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">ylab =</span> <span class="st">"TS 1"</span>, <span class="at">main =</span> <span class="st">"Detrended - Moving Average Smoother (5 point)"</span>, <span class="at">pch =</span> <span class="dv">16</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lecture7_files/figure-html/astsa_act2_p4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>(extra content)<code>ggplot</code> version</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(all_ts, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> detrended_ma)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"TS 1"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Detrended - Moving Average Smoother (5 point)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="5" type="1">
<li>In a separate plot, again plot the time series as points and also plot a simple linear regression line using <code>time(x)</code> where x is the time series you are analyzing. Add the fitted values to the <code>all_ts</code> data frame.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>lm_x_t <span class="ot">&lt;-</span> <span class="fu">lm</span>(x_t<span class="sc">~</span>Time, <span class="at">data =</span> all_ts)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tsplot</span>(all_ts<span class="sc">$</span>x_t, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">ylab =</span> <span class="st">"TS 1"</span>, <span class="at">main =</span> <span class="st">"Linear Trend"</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>all_ts<span class="sc">$</span>reg_x_t <span class="ot">&lt;-</span> lm_x_t<span class="sc">$</span>fitted.values</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(all_ts<span class="sc">$</span>reg_x_t, <span class="at">col =</span> <span class="st">"turquoise"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lecture7_files/figure-html/astsa_act2_part5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>(extra content)<code>ggplot</code> version</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(all_ts, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> x_t)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"TS 1"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Linear Trend"</span>) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span> Time, <span class="at">y =</span> reg_x_t), <span class="at">col =</span> <span class="st">"turquoise"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="6" type="1">
<li>Detrend the time series with respect to the regression and plot and save the detrended series (save in the all_ts data frame).</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>all_ts<span class="sc">$</span>detrended_reg <span class="ot">&lt;-</span> all_ts<span class="sc">$</span>x_t <span class="sc">-</span> all_ts<span class="sc">$</span>reg_x_t</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tsplot</span>(all_ts<span class="sc">$</span>detrended_reg, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">ylab =</span> <span class="st">"TS 1"</span>, <span class="at">main =</span> <span class="st">"Detrended - Linear Trend"</span>, <span class="at">pch =</span> <span class="dv">16</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lecture7_files/figure-html/astsa-act2-p6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>(extra content)<code>ggplot</code> version</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(all_ts, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> detrended_reg)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"TS 1"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Detrended - Linear Trend"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="7" type="1">
<li>Difference the time series, plot as points and lines and save the differenced series.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>all_ts<span class="sc">$</span>differenced <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">diff</span>(all_ts<span class="sc">$</span>x_t), <span class="cn">NA</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tsplot</span>(all_ts<span class="sc">$</span>differenced, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">ylab =</span> <span class="st">"TS 1"</span>, <span class="at">main =</span> <span class="st">"Differenced Series"</span>, <span class="at">pch =</span> <span class="dv">16</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lecture7_files/figure-html/astsa-act2-p7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>(extra content)<code>ggplot</code> version</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(all_ts, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> differenced)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"TS 1"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Differenced Series"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="7" type="1">
<li><code>Run par(mfrow = c(2,3))</code> and then re-run the plotting code for all 6 plots you just made in steps 1-6.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># number 1</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tsplot</span>(all_ts<span class="sc">$</span>x_t, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">ylab =</span> <span class="st">"TS 1"</span>, <span class="at">main =</span> <span class="st">"Observed Time Series"</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="do">## number 2</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tsplot</span>(all_ts<span class="sc">$</span>x_t, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">ylab =</span> <span class="st">"TS 1"</span>, <span class="at">main =</span> <span class="st">"MA(5) Smoother"</span>, <span class="at">pch =</span> <span class="dv">16</span> )</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(all_ts<span class="sc">$</span>ma_x_t, <span class="at">col =</span> <span class="st">"magenta"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co"># number 3</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="fu">tsplot</span>(all_ts<span class="sc">$</span>detrended_ma, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">ylab =</span> <span class="st">"TS 1"</span>, <span class="at">main =</span> <span class="st">"Detrended - MA(5)"</span>, <span class="at">pch =</span> <span class="dv">16</span> )</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Number 4</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="fu">tsplot</span>(all_ts<span class="sc">$</span>x_t, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">ylab =</span> <span class="st">"TS 1"</span>, <span class="at">main =</span> <span class="st">"Linear Trend"</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(all_ts<span class="sc">$</span>reg_x_t, <span class="at">col =</span> <span class="st">"turquoise"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co"># number 5</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="fu">tsplot</span>(all_ts<span class="sc">$</span>detrended_reg, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">ylab =</span> <span class="st">"TS 1"</span>, <span class="at">main =</span> <span class="st">"Detrended - Linear Trend"</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Number 6</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="fu">tsplot</span>(all_ts<span class="sc">$</span>differenced, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">ylab =</span> <span class="st">"TS 1"</span>, <span class="at">main =</span> <span class="st">"Differenced"</span>, <span class="at">pch =</span> <span class="dv">16</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lecture7_files/figure-html/all_parts-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="short-answer-answers" class="level3">
<h3 class="anchored" data-anchor-id="short-answer-answers">Short answer answers</h3>
<ul>
<li>Which plots look like stationary time series?</li>
</ul>
<p><strong>In terms of the “data” (black points/lines in upper left and middle and lower left), the plot looks fairly stationary– no increasing or cyclical trend, and looks fairly similar to white noise (which is stationary). The detrended (MA and Linear) and the differenced plots look very similar, so they seem stationary as well.</strong></p>
<p><strong>In terms of the time series generated from creating trend estimates from each time point, we have two: the MA(5) and the linear trend. The linear trend is very slightly negative, but essentially horizontal– stationary.</strong></p>
<p><strong>The MA(5) smoother has fluctuations but those don’t seem to be explicitly based directly on time (or for particular time lags, i.e.&nbsp;not seasonal), which would suggest stationarity (though perhaps some temporal structure– we can check the acf.)</strong></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Regression significance tests that suggest white noise.
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Running <code>summary(lm_x_t)</code> contains the test statistics and p-values for some hypothesis tests for the regression parameters.</p>
<ul>
<li>Here, we have a p-value of 0.369 for the test for a zero slope, meaning we do not have evidence the slope of the trend is not zero.</li>
<li>The default test of significance for the y-intercept is actually testing whether it’s 0, and that we also fail to reject that the y-intercept is different from 0 (p-value 0.285.</li>
</ul>
<p>In other words, we fail to find evidence that the mean is not constant and 0, which is true for white noise. So it kinda seems like white noise.</p>
</div>
</div>
</div>
<ul>
<li>Can you guess the model/source of <span class="math inline">\(x_t\)</span> from these plots?</li>
</ul>
<p><strong>It looks like white noise, but the acf can give us more insight into that in Activity 4.</strong></p>
<ul>
<li>How many trends have we estimated?</li>
</ul>
<p><strong>We have estimated two trends. Note that differencing a series does not give us an estimate of the trend.</strong></p>
</section>
</section>
<section id="activity-3" class="level2">
<h2 class="anchored" data-anchor-id="activity-3">Activity 3</h2>
<p>Use the function <code>process_ts</code> to create the plots for the remaining series.</p>
<p><strong>Note that we estimate the same two trend models (MA(5) and linear) for each series (though the particular parameters will be different for each of the raw series).</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"Code/process_ts.r"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">process_ts</span>(time_series<span class="sc">$</span>y1, <span class="at">ptitle =</span> <span class="st">"TS1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lecture7_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Which plots look like stationary time series?</li>
</ul>
<p><strong>see above</strong></p>
<ul>
<li>Can you guess the model/source of <span class="math inline">\(x_t\)</span> from these plots?</li>
</ul>
<p><strong>see above</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">process_ts</span>(time_series<span class="sc">$</span>y2, <span class="at">ptitle =</span> <span class="st">"TS2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lecture7_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>Which plots look like stationary time series?</p></li>
<li><p>The detrended MA and differenced series look very much like white noise, which implies stationary.</p></li>
<li><p>The detrended linear trend is almost identical to the raw data (which makes sense since the linear regression estimates essentially a constant mean of 0).</p></li>
<li><p>The raw data does not appear to have an overall increasing trend, nor any predictable seasonal patterns (not a linear trend stationary, unless I was being mean). However, it does not really look like white noise.</p></li>
</ul>
<p>So that means <code>y2</code> may be a moving average or perhaps real data.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
How I could have been mean
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Technically, a (deterministic) linear trend stationary model with the usual regression residuals with mean and y-intercept 0 is equivalent to white noise.</p>
</div>
</div>
</div>
<ul>
<li>Can you guess the model/source of <span class="math inline">\(x_t\)</span> from these plots?</li>
</ul>
<p>Not exactly! The Acf will reveal more about the temporal structure.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">process_ts</span>(time_series<span class="sc">$</span>y3, <span class="at">ptitle =</span> <span class="st">"TS3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lecture7_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Which plots look like stationary time series?</li>
<li>Can you guess the model/source of <span class="math inline">\(x_t\)</span> from these plots?</li>
</ul>
<p><strong>(Answering both) The plots for <code>y3</code> are somewhat similar to those for <code>y2</code>, so this may be the duplicated model (not white noise, though). However, there are some differences. The linear trend is more pronounced, but still appears somewhat shallow. Looking at the raw series, the appearance of temporal structure is even more pronounced. So, perhaps this the deterministic linear model with a very shallow trend (technically still nonstationary), or it’s a moving average, or real data.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">process_ts</span>(time_series<span class="sc">$</span>y4, <span class="at">ptitle =</span> <span class="st">"TS4"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lecture7_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Which plots look like stationary time series?</li>
</ul>
<p>The detrended and differenced plots look stationary. The observed time series looks like an obvious deterministic linear trend, which the linear trend and moving average trend pick up on (though the moving average is a “bumpy” estimate of the linear trend– but there does not appear to be any cyclical structure.)</p>
<ul>
<li>Can you guess the model/source of <span class="math inline">\(x_t\)</span> from these plots?</li>
</ul>
<p><strong>This could technically be real data, if that real data followed a perfect linear trend in time. It’s definitely not white noise or a pure moving average model (generated from white noise).</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">process_ts</span>(time_series<span class="sc">$</span>y5, <span class="at">ptitle =</span> <span class="st">"TS5"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lecture7_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Which plots look like stationary time series?</li>
</ul>
<p><strong>The MA-detrended and differenced series look stationary. The raw data looks like it is at one level for the beginning of the series and then drops down for the remainder. That pattern is more pronounced in the moving average overaly plot. The linear trend is decreasing, but does not appear to capture the pattern of the data very well (the decrease in the data is abrupt, not linear and gradual).</strong></p>
<ul>
<li>Can you guess the model/source of <span class="math inline">\(x_t\)</span> from these plots?</li>
</ul>
<p><strong>None of the models (moving average, linear trend, white noise) can have an abrupt change in level like we see in this time series. By process of elimination, this appears to be the real data.</strong></p>
</section>
<section id="activity-4" class="level2">
<h2 class="anchored" data-anchor-id="activity-4">Activity 4</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>plot_acfs <span class="ot">&lt;-</span> <span class="cf">function</span>(dataset, main){</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  all_ts <span class="ot">&lt;-</span> <span class="fu">process_ts</span>(dataset, <span class="at">ptitle =</span> <span class="st">""</span>, <span class="at">output =</span> T, <span class="at">plots =</span> F)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span>  forecast<span class="sc">::</span><span class="fu">ggAcf</span>(all_ts<span class="sc">$</span>x_t)  <span class="sc">+</span> <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="fu">names</span>(all_ts)[<span class="dv">1</span>]) <span class="sc">+</span>  <span class="fu">plot_layout</span>(<span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">names</span>(all_ts)[<span class="sc">!</span>(<span class="fu">names</span>(all_ts)<span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Time"</span>, <span class="st">"x_t"</span>))]){</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> forecast<span class="sc">::</span><span class="fu">ggAcf</span>(all_ts[, i])  <span class="sc">+</span> <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(i) </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> p <span class="sc">+</span> g<span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="fu">paste</span>(main))</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_acfs</span>(time_series<span class="sc">$</span>y1, <span class="at">main =</span> <span class="st">"TS 1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'quantmod':
  method            from
  as.zoo.data.frame zoo </code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lecture7_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_acfs</span>(time_series<span class="sc">$</span>y2, <span class="at">main =</span> <span class="st">"TS 2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lecture7_files/figure-html/unnamed-chunk-22-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_acfs</span>(time_series<span class="sc">$</span>y3, <span class="at">main =</span> <span class="st">"TS 3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lecture7_files/figure-html/unnamed-chunk-22-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_acfs</span>(time_series<span class="sc">$</span>y4, <span class="at">main =</span> <span class="st">"TS 4"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lecture7_files/figure-html/unnamed-chunk-22-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_acfs</span>(time_series<span class="sc">$</span>y5, <span class="at">main =</span> <span class="st">"TS 5"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lecture7_files/figure-html/unnamed-chunk-22-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="acf-of-the-ys" class="level4">
<h4 class="anchored" data-anchor-id="acf-of-the-ys">ACF of the <code>y</code>’s</h4>
<ul>
<li><code>y1</code>- looks like white noise</li>
<li><code>y2</code>- clearly has lag 1 autocorrelation, maybe a but at lag 2, then drops off. A bit of a pattern in later lags</li>
<li><code>y3</code>- has autocorrelation for lags 1-4, then drops off around 5. A bit of a pattern in later lags like <code>y2</code>, but more pronounced than <code>y2</code>.</li>
<li><code>y4</code>- This is the one we think is the linear trend model. Clearly there is nonstationarity in the acf of the data, which we’d expect to see from a linear trend.</li>
<li><code>y5</code>- This looks unlike any of the others. There appears to be moderate lag 1 autocorrelation which drops off slowly.</li>
</ul>
</section>
<section id="acf-of-the-ma5-estimates" class="level4">
<h4 class="anchored" data-anchor-id="acf-of-the-ma5-estimates">ACF of the MA(5) estimates</h4>
<ul>
<li><code>y1</code>- Since it appears we started with white noise, it makes sense that we can clearly identify a moving average structure in the time series that we made by applying a moving average. We are seeing the structure we built into our MA(5) trend estimate.</li>
<li><code>y2</code>- Looks very similar to <code>y1</code>.</li>
<li><code>y3</code>- Similar to the first two, but has larger autocorrelation for lags 1-4.</li>
<li><code>y4</code>- Looks the same as the acf of <code>y4</code>, and drops off very slowly. Our MA estimate essentially is a linear trend, so it’s not surprising to see this structure in the acf.</li>
<li><code>y5</code>- Again, this looks like none of the others. We see the larger autocorrelation at small lags induced by the MA smoothing, but we also see more persistent long-range lag relations.</li>
</ul>
</section>
<section id="acf-of-the-ma-5-detrended" class="level4">
<h4 class="anchored" data-anchor-id="acf-of-the-ma-5-detrended">ACF of the MA-5 detrended</h4>
<p>None of the MA(5)- detrended series look particularly like white noise, which is what we would want to see if we had fully accounted for the temporal structure in our model.</p>
<ul>
<li><code>y1</code>- has some temporal structure, likely due to the fact that we appear to have started with white noise and then subtracted out the MA structure</li>
<li><code>y2</code>- has even more structure than <code>y1</code></li>
<li><code>y3</code>- looks like white noise, except for a peak at <code>y5</code></li>
<li><code>y4</code>- looks almost like white noise, except for lag 1 and 2 showing some modest negative autocorrelation</li>
<li><code>y5</code>- looks kind of like the white noise, but perhaps has a bit of structure</li>
</ul>
</section>
<section id="acf-of-the-linear-trends" class="level4">
<h4 class="anchored" data-anchor-id="acf-of-the-linear-trends">ACF of the linear trends</h4>
<p>These all look very similar. That is because each of our linear trend models are deterministic functions of <span class="math inline">\(t\)</span>– they will show this autocorrelation regardless of the steepness of the slope (unless it’s literally 0).</p>
</section>
<section id="acf-of-the-linearly-detrended" class="level4">
<h4 class="anchored" data-anchor-id="acf-of-the-linearly-detrended">ACF of the linearly detrended</h4>
<ul>
<li><code>y1</code>- Looks like white noise– unsurprising since we subtracted off a near horizontal trend of 0, and we suspect a linear model</li>
<li><code>y2</code>- has significant autocorrelation at lag 1– looks like the regression does <em>not</em> have independent errors, so probably not a great model</li>
<li><code>y3</code>- same as <code>y2</code>, but has a larger autocorrelation and for lags 2 and 3 as well</li>
<li><code>y4</code>- Looks like white noise– unsurprising since we linearly detrended and we suspect a linear model.</li>
<li><code>y5</code>- Not quite like white noise (most autocorrelations are small but positive), but doesn’t look too bad.</li>
</ul>
</section>
<section id="acf-of-the-differences" class="level4">
<h4 class="anchored" data-anchor-id="acf-of-the-differences">ACF of the differences</h4>
<ul>
<li><code>y1</code>- Significant lag 1 autocorrelation (makes sense since we differenced white noise, which added some dependence)</li>
<li><code>y2</code>- Significant lag 3 autocorrelation</li>
<li><code>y3</code>- Significant lag 5 autocorrelation</li>
<li><code>y4</code>- some lag 1 autocorrelation</li>
<li><code>y5</code>- some lag 1 autocorrelation</li>
</ul>
</section>
</section>
<section id="simulation-solutions." class="level2">
<h2 class="anchored" data-anchor-id="simulation-solutions.">Simulation solutions.</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0016</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate white noise.</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate an MA(3) </span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N<span class="sc">+</span><span class="dv">50</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">filter</span>(w, <span class="at">filter =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>,<span class="dv">3</span>), </span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"convolution"</span>, <span class="at">sides =</span> <span class="dv">2</span>)[<span class="dv">2</span><span class="sc">:</span><span class="dv">101</span>]</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate an MA(5)</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N<span class="sc">+</span><span class="dv">50</span>)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">filter</span>(w, <span class="at">filter =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>,<span class="dv">5</span>), </span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">"convolution"</span>, <span class="at">sides =</span> <span class="dv">2</span>)[<span class="dv">10</span><span class="sc">:</span><span class="dv">109</span>]</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate trend stationary</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="dv">0</span>, <span class="dv">20</span>)</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>time_index <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>N</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>y4 <span class="ot">&lt;-</span> <span class="fl">2.718</span> <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>time_index <span class="sc">+</span> w</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="do">## real data </span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Nile, <span class="at">package =</span> <span class="st">"datasets"</span>)</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>y5 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(Nile)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="why-doesnt-the-acf-of-the-ma5-look-like-white-noise" class="level2">
<h2 class="anchored" data-anchor-id="why-doesnt-the-acf-of-the-ma5-look-like-white-noise">Why doesn’t the acf of the MA(5) look like white noise?</h2>
<ul>
<li><p>I’m not exactly sure, but something about the estimation procedure in the <code>stats::filter()</code> function</p></li>
<li><p>If you fit using the <code>arima</code> function, it looks fine:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>ma_5_mod <span class="ot">&lt;-</span> <span class="fu">arima</span>(time_series<span class="sc">$</span>y3, <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>))</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(ma_5_mod<span class="sc">$</span>resid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lecture7_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Estimation procedure matters!</li>
</ul>
</section>
<section id="a-bit-about-the-nile-data" class="level2">
<h2 class="anchored" data-anchor-id="a-bit-about-the-nile-data">A bit about the Nile Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tsplot</span>(Nile, <span class="at">xlab =</span> <span class="st">"Year"</span>, <span class="at">ylab =</span> <span class="st">"Discharge at Aswan, 10^8 m^3"</span>, <span class="at">main =</span> <span class="st">"Annual Volume"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lecture7_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="wheres-aswan" class="level2">
<h2 class="anchored" data-anchor-id="wheres-aswan">Where’s Aswan?</h2>
<p>Sun directly overhead at noon on the summer solstice– where the circumference of the earth was calculated like 2000 years ago. So cool!!! (not related to this data set(?))</p>
<p><img src="images/Egypt map.png" class="img-fluid"></p>
</section>
<section id="a-bit-about-the-nile-data-1" class="level2">
<h2 class="anchored" data-anchor-id="a-bit-about-the-nile-data-1">A bit about the Nile Data</h2>
<p>“Level shift visible in the data at 1898” – how do we model “abrupt changes in distribution”?</p>
<p><img src="images/table.png" class="img-fluid"></p>
</section>
<section id="check-out-the-paper" class="level2">
<h2 class="anchored" data-anchor-id="check-out-the-paper">Check out the paper!</h2>
<p><img src="images/early_time_series.png" class="img-fluid"></p>
</section>
<section id="whos-barbara-bell" class="level2">
<h2 class="anchored" data-anchor-id="whos-barbara-bell">Who’s Barbara Bell?</h2>
<p>She’s not cited formally… (data sets now get their own DOIs, ideally)</p>
<ul>
<li><p>Got her PhD at Harvard in 1944 in Astrophysics</p>
<ul>
<li><a href="https://www.radcliffe.harvard.edu/event/2012-its-complicated-exhibition#:~:text=Mary%20Whiton%20Calkins%20(Smith%20AB,1886%2C%201890%E2%80%931891).">History of women at Harvard/Radcliffe</a> (a bit of a bummer to read)</li>
</ul></li>
</ul>
<p>From (one of) her Obituary(ies):</p>
<p>“Working with Donald Menzel, Harold Glazer, Giancarlo Noci and Robert Kurucz, <strong>her research dealt primarily with observations of solar phenomena</strong>. Barbara had a keen interest in history and travel, and in her later years traveled to all corners of the globe. She developed a particular interest in the ancient history of Egypt. <strong>Her research expanded to include the variations in the floods of the Nile for which she sought to connect to solar fluctuations</strong>. Using ancient accounts, she was <strong>first to propose a linkage between prolonged drought and the societal collapse she called ”The First Dark Age in Egypt”</strong> in the early 1970s. She published several journal articles on the connection of climate fluctuations to the fall of Egyptian dynasties which have been widely cited in the literature. Loved by all who knew her, Barbara had <strong>a sharp and curious mind, a kind heart and a cheerful disposition</strong>. Intensely interested in her family and those around her, she donated generously her entire life to Harvard University and numerous charities. A <strong>beloved sister and aunt</strong>…”</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/juliaSchedler\.github\.io\/Stat416_CourseWebsite\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>